{"version":3,"sources":["./cast/sender/webpack/bootstrap","./cast/sender/external [\"KalturaPlayer\"]","./cast/sender/./cast-state-manager.js","./cast/sender/./cast-tracks-manager.js","./cast/sender/./cast-playback-engine.js","./cast/sender/./cast-ui.js","./cast/sender/./cast-loader.js","./cast/sender/./cast-ads-controller.js","./cast/sender/./cast-ads-manager.js","./cast/sender/./cast-player.js","./cast/sender/./index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","KalturaPlayer","State","core","FakeEvent","EventType","FakeEventTarget","StateType","CastStateManager","remotePlayer","remotePlayerController","_remotePlayer","_remotePlayerController","_currentState","IDLE","_previousState","_updateState","addEventListener","cast","framework","RemotePlayerEventType","PLAYER_STATE_CHANGED","this","duration","Date","now","playerState","toLowerCase","dispatchEvent","oldState","previousState","newState","currentState","reset","destroy","removeEventListener","TextStyleConverter","remote","Track","getLogger","TextStyle","AudioTrack","VideoTrack","TextTrack","Utils","TrackType","Error","TRACK_TYPE_TO_INSTANCE","AUDIO","VIDEO","TEXT","CastTracksManager","_logger","_castSession","CastContext","getInstance","getCurrentSession","_textStyle","_bindEvents","parseTracks","tracks","mediaInfo","length","castTextTracks","filter","type","chrome","media","castVideoTracks","castAudioTracks","textTracks","_parseTextTracks","videoTracks","_parseVideoTracks","audioTracks","_parseAudioTracks","_tracks","concat","_addTextTrackOffOption","debug","_startOnMediaStatusUpdateInterval","TRACKS_CHANGED","getTracks","copyDeep","_getTracksByType","getActiveTracks","video","find","track","active","audio","text","selectTrack","_selectVideoTrack","_selectAudioTrack","_selectTextTrack","hideTextTrack","offTrack","language","_stopOnMediaStatusUpdateInterval","_activeTrackIds","_mediaStatusIntervalId","setInterval","_onMediaStatusUpdate","INTERVAL_FREQUENCY","clearInterval","pushTextTrack","settings","id","trackId","index","label","kind","subType","push","inbandCastTextTracks","outbandCastTextTracks","forEach","trackContentId","some","inbandTrack","langComparer","warn","currentTrack","_selectTrack","VIDEO_TRACK_CHANGED","selectedVideoTrack","error","ERROR","Severity","RECOVERABLE","Category","CAST","Code","EDIT_TRACKS_INFO_ERROR","AUDIO_TRACK_CHANGED","selectedAudioTrack","CAST_EDIT_TRACKS_INFO_ERROR","TEXT_TRACK_CHANGED","selectedTextTrack","newTrack","onSuccess","onFailed","indexOf","splice","tracksInfoRequest","EditTracksInfoRequest","getMediaSession","editTracksInfo","_markActiveTrack","e","origTrack","localTextStyle","remoteTextStyle","mediaSession","activeTrackIds","every","includes","toCastTextStyle","textStyle","textTrackStyle","backgroundColor","fontFamily","fontScale","foregroundColor","style","toPlayerTextStyle","TEXT_STYLE_CHANGED","clone","CastPlaybackEngine","_toggleListeners","_liveCurrentTimeIntervalId","_resetFlags","_muted","_volume","play","playOrPause","pause","canPause","_paused","_currentTime","_duration","_seeking","_onCurrentTimeChanged","_onIsPausedChanged","_onDurationChanged","_onVolumeLevelChanged","_onIsMutedChanged","_onIsMediaLoadedChanged","_onLiveCurrentTimeChanged","listen","listeners","IS_MEDIA_LOADED_CHANGED","IS_PAUSED_CHANGED","DURATION_CHANGED","VOLUME_LEVEL_CHANGED","IS_MUTED_CHANGED","keys","CURRENT_TIME_CHANGED","isMediaLoadedEvent","MEDIA_INFO_CHANGED","onMediaInfoChanged","streamType","StreamType","LIVE","_mediaSession","currentTime","_maybeDispatchTimeUpdate","_maybeEndPlayback","_maybeEndLivePlayback","isPaused","PAUSE","PLAY","DURATION_CHANGE","volumeLevel","VOLUME_CHANGE","isMuted","MUTE_CHANGE","mute","muted","_seekTargetTime","_seekForward","SEEKED","TIME_UPDATE","delta","Math","round","ENDED","range","liveSeekableRange","isLiveDone","muteOrUnmute","canControlVolume","setVolumeLevel","canSeek","SEEKING","seek","savedPlayerState","ui","Components","h","CastUI","playbackUI","props","className","playbackGuiWrapper","KeyboardControl","player","config","Loading","playerGui","OverlayPortal","BottomBar","SeekBarPlaybackContainer","showFramePreview","showTimeBubble","playerContainer","leftControls","PlaybackControls","RewindControl","step","ForwardControl","TimeDisplayPlaybackContainer","format","rightControls","VolumeControl","LanguageControl","CastControl","FullscreenControl","CastOverlay","OverlayAction","PrePlaybackPlayOverlay","CastAfterPlay","liveUI","SeekBarLivePlaybackContainer","LiveTag","idleUI","adsUI","adGuiWrapper","TopBar","AdNotice","AdLearnMore","AdSkip","TimeDisplayAdsContainer","RemotePlayerUI","CastLoader","load","Promise","resolve","reject","window","isAvailable","_onGCastApiAvailable","_loadCastSDK","then","catch","Dom","loadScriptAsync","toString","CustomActionMessage","CustomActionType","CastAdsController","skipAd","sendMessage","CUSTOM_CHANNEL","SKIP_AD","EventManager","CastAdsManager","castPlayer","_castPlayer","_eventManager","_attachListeners","AD_MANIFEST_LOADED","_allAdsCompleted","AD_BREAK_START","_adBreak","AD_BREAK_END","ALL_ADS_COMPLETED","removeAll","Env","EngineType","AbrMode","BaseRemotePlayer","PlayerSnapshot","RemoteConnectedPayload","RemoteControl","RemoteDisconnectedPayload","RemoteAvailablePayload","RemoteSession","CustomMessageType","CustomMessage","CustomEventMessage","CastPlayer","castConfig","remoteControl","_initializeCastApi","_initializeRemotePlayer","isSupported","browser","os","loadMedia","options","_mediaInfo","_castMedia","setMedia","mediaConfig","getMediaInfo","getMediaConfig","sources","_playerConfig","plugins","ready","_readyPromise","ended","_adsManager","adBreak","_engine","_loadOrSetMedia","_mediaInfoIntervalId","_reset","_firstPlay","_ended","_isOnLiveEdge","_tracksManager","_stateManager","_createReadyPromise","PLAYER_RESET","_destroyed","PLAYER_DESTROY","isLive","_castRemotePlayer","isOnLiveEdge","isDvr","startMinutes","start","end","_castConfig","liveEdgeThreshold","seekToLiveEdge","getStartTimeOfDvrWindow","startCasting","requestSession","isCastAvailable","stopCasting","endSession","getCastSession","_remoteSession","receiverApplicationId","DEFAULT_MEDIA_RECEIVER_APP_ID","autoJoinPolicy","AutoJoinPolicy","ORIGIN_SCOPED","castContext","setOptions","CastContextEventType","CAST_STATE_CHANGED","event","payload","castState","CastState","NO_DEVICES_AVAILABLE","_remoteControl","onRemoteDeviceAvailable","_castContext","_addSessionLifecycleListeners","RemotePlayer","_castRemotePlayerController","RemotePlayerController","IS_CONNECTED_CHANGED","isConnected","_setupRemotePlayer","_setupLocalPlayer","addMessageListener","customChannel","customMessage","_onCustomMessage","_ui","snapshot","getPlayerSnapshot","getSessionId","getCastDevice","friendlyName","getSessionState","SessionState","SESSION_STARTED","onRemoteDeviceConnected","resuming","major","loadOptions","_getLoadOptions","_resumeSession","mediaObject","getUIWrapper","_playbackStarted","CHANGE_SOURCE_STARTED","MediaInfo","request","LoadRequest","option","mediaOption","customData","_onLoadMediaSuccess","_onLoadMediaFailed","onRemoteDeviceDisconnected","listenOnce","MEDIA_LOADED","_onPause","_onEnded","_onPlayerStateChanged","allAdsCompleted","PLAYBACK_ENDED","PLAYING","_handleFirstPlay","CHANGE_SOURCE_ENDED","PLAYBACK_START","FIRST_PLAY","FIRST_PLAYING","paused","_triggerInitialPlayerEvents","startTime","playback","SOURCE_SELECTED","selectedSource","url","contentUrl","mimetype","contentType","LOADED_METADATA","ABR_MODE_CHANGED","AUTO","CRITICAL","CAST_LOAD_MEDIA_FAILED","SESSION_STATE_CHANGED","sessionState","SESSION_STARTING","onRemoteDeviceConnecting","SESSION_RESUMED","SESSION_ENDING","onRemoteDeviceDisconnecting","SESSION_START_FAILED","onRemoteDeviceConnectFailed","autoplay","isEqual","audioLanguage","textLanguage","advertising","adTagUrl","_adsController","castAdvertising","vast","breakClipId","Generator","uniqueId","breakId","breakClips","position","vastAdsRequest","_getAdsRequest","breaks","breakClipIds","vmapAdsRequest","externalCaptions","_getExternalCaptions","captions","caption","endsWith","mergeDeep","trackContentType","adsRequest","adsResponse","parsedCustomMessage","JSON","parse","EVENT","_handleCustomEvent","CAST_CUSTOM_MESSAGE_PARSING_ERROR","customEvent","to","vol","volume","seeking","metadata","images","playbackRate","Type","registerRemotePlayer","NAME","__NAME__","VERSION","__VERSION__"],"mappings":"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","file":"playkit-cast-sender.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = KalturaPlayer;","//@flow\nimport {core} from 'kaltura-player-js';\n\nconst {State, FakeEvent, EventType, FakeEventTarget, StateType} = core;\n\nclass CastStateManager extends FakeEventTarget {\n  _currentState: State;\n  _previousState: State;\n  _remotePlayer: Object;\n  _remotePlayerController: Object;\n  _updateState: Function;\n\n  constructor(remotePlayer: Object, remotePlayerController: Object) {\n    super();\n    this._remotePlayer = remotePlayer;\n    this._remotePlayerController = remotePlayerController;\n    this._currentState = new State(StateType.IDLE);\n    this._previousState = new State(StateType.IDLE);\n    this._updateState = this._updateState.bind(this);\n    this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED, this._updateState);\n  }\n\n  _updateState(): void {\n    this._currentState.duration = Date.now() / 1000;\n    this._previousState = this._currentState;\n    if (this._remotePlayer.playerState) {\n      this._currentState = new State(this._remotePlayer.playerState.toLowerCase());\n    } else {\n      this._currentState = new State(StateType.IDLE);\n    }\n    this.dispatchEvent(\n      new FakeEvent(EventType.PLAYER_STATE_CHANGED, {\n        oldState: this.previousState,\n        newState: this.currentState\n      })\n    );\n  }\n\n  reset(): void {\n    this._currentState = new State(StateType.IDLE);\n    this._previousState = new State(StateType.IDLE);\n  }\n\n  destroy(): void {\n    this._remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED, this._updateState);\n    this._currentState = new State(StateType.IDLE);\n    this._previousState = new State(StateType.IDLE);\n  }\n\n  get currentState(): State {\n    return this._currentState;\n  }\n\n  get previousState(): State {\n    return this._previousState;\n  }\n}\n\nexport {CastStateManager};\n","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {INTERVAL_FREQUENCY} from './cast-player';\n\nconst {TextStyleConverter} = remote;\nconst {Track, getLogger, TextStyle, AudioTrack, VideoTrack, TextTrack, Utils, TrackType, EventType, FakeEvent, FakeEventTarget, Error} = core;\nconst TRACK_TYPE_TO_INSTANCE: {[type: string]: Track} = {\n  [TrackType.AUDIO]: AudioTrack,\n  [TrackType.VIDEO]: VideoTrack,\n  [TrackType.TEXT]: TextTrack\n};\n\nclass CastTracksManager extends FakeEventTarget {\n  _remotePlayer: Object;\n  _castSession: Object;\n  _textStyle: TextStyle;\n  _activeTrackIds: Array<number> = [];\n  _tracks: Array<Track> = [];\n  _mediaStatusIntervalId: ?IntervalID;\n  _onMediaStatusUpdate: Function;\n  _logger: any;\n\n  constructor(remotePlayer: Object) {\n    super();\n    this._remotePlayer = remotePlayer;\n    this._logger = getLogger('CastTracksManager');\n    this._castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n    this._textStyle = new TextStyle();\n    this._bindEvents();\n  }\n\n  parseTracks(): void {\n    const tracks = this._remotePlayer.mediaInfo.tracks;\n    if (tracks && tracks.length > 0) {\n      const castTextTracks = tracks.filter(t => t.type === chrome.cast.media.TrackType.TEXT);\n      const castVideoTracks = tracks.filter(t => t.type === chrome.cast.media.TrackType.VIDEO);\n      const castAudioTracks = tracks.filter(t => t.type === chrome.cast.media.TrackType.AUDIO);\n      const textTracks = this._parseTextTracks(castTextTracks);\n      const videoTracks = this._parseVideoTracks(castVideoTracks);\n      const audioTracks = this._parseAudioTracks(castAudioTracks);\n      this._tracks = audioTracks.concat(videoTracks).concat(textTracks);\n      this._addTextTrackOffOption();\n    }\n    this._logger.debug('Parse tracks', this._tracks);\n    this._startOnMediaStatusUpdateInterval();\n    this.dispatchEvent(new FakeEvent(EventType.TRACKS_CHANGED, {tracks: this._tracks}));\n  }\n\n  getTracks(type?: string): Array<Track> {\n    return Utils.Object.copyDeep(this._getTracksByType(type));\n  }\n\n  getActiveTracks(): Object {\n    return Utils.Object.copyDeep({\n      video: this._getTracksByType(TrackType.VIDEO).find(track => track.active),\n      audio: this._getTracksByType(TrackType.AUDIO).find(track => track.active),\n      text: this._getTracksByType(TrackType.TEXT).find(track => track.active)\n    });\n  }\n\n  selectTrack(track: ?Track): void {\n    if (track instanceof VideoTrack) {\n      this._selectVideoTrack(track);\n    } else if (track instanceof AudioTrack) {\n      this._selectAudioTrack(track);\n    } else if (track instanceof TextTrack) {\n      this._selectTextTrack(track);\n    }\n  }\n\n  hideTextTrack(): void {\n    const offTrack = this._tracks.find(t => t.language === 'off');\n    this.selectTrack(offTrack);\n  }\n\n  reset(): void {\n    this._stopOnMediaStatusUpdateInterval();\n    this._tracks = [];\n    this._activeTrackIds = [];\n  }\n\n  destroy(): void {\n    this._stopOnMediaStatusUpdateInterval();\n    this._tracks = [];\n    this._activeTrackIds = [];\n  }\n\n  set textStyle(style: TextStyle): void {\n    this._logger.debug('Setting text style', style);\n    const textTrackStyle = TextStyleConverter.toCastTextStyle(style);\n    const tracksInfoRequest = new chrome.cast.media.EditTracksInfoRequest(null, textTrackStyle);\n    const mediaSession = this._castSession.getMediaSession();\n    mediaSession.editTracksInfo(\n      tracksInfoRequest,\n      () => {\n        this._logger.debug('Setting text style succeed');\n        this._textStyle = style;\n        this.dispatchEvent(new FakeEvent(EventType.TEXT_STYLE_CHANGED, {textStyle: style}));\n      },\n      error => {\n        this._logger.debug('Setting text style failed', error);\n        this.dispatchEvent(\n          new FakeEvent(EventType.ERROR, new Error(Error.Severity.RECOVERABLE, Error.Category.CAST, Error.Code.EDIT_TRACKS_INFO_ERROR, error))\n        );\n      }\n    );\n  }\n\n  get textStyle(): ?TextStyle {\n    return this._textStyle.clone();\n  }\n\n  _startOnMediaStatusUpdateInterval(): void {\n    if (!this._mediaStatusIntervalId) {\n      this._mediaStatusIntervalId = setInterval(this._onMediaStatusUpdate, INTERVAL_FREQUENCY);\n    }\n  }\n\n  _stopOnMediaStatusUpdateInterval(): void {\n    if (this._mediaStatusIntervalId) {\n      clearInterval(this._mediaStatusIntervalId);\n      this._mediaStatusIntervalId = null;\n    }\n  }\n\n  _bindEvents(): void {\n    this._onMediaStatusUpdate = this._onMediaStatusUpdate.bind(this);\n  }\n\n  _parseTextTracks(castTextTracks: Array<Object>): Array<TextTrack> {\n    const textTracks = [];\n    const pushTextTrack = track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        kind: track.subType || 'subtitles',\n        active: false\n      };\n      textTracks.push(new TextTrack(settings));\n    };\n    const inbandCastTextTracks = [];\n    const outbandCastTextTracks = [];\n    castTextTracks.forEach(track => {\n      if (track.trackContentId) {\n        outbandCastTextTracks.push(track);\n      } else {\n        inbandCastTextTracks.push(track);\n      }\n    });\n    inbandCastTextTracks.forEach(pushTextTrack);\n    outbandCastTextTracks.forEach(track => {\n      if (inbandCastTextTracks.some(inbandTrack => Track.langComparer(track.language, inbandTrack.language))) {\n        this._logger.warn('duplicated language, taking the inband option. Language: ', track.language);\n      } else {\n        pushTextTrack(track);\n      }\n    });\n    return textTracks;\n  }\n\n  _parseVideoTracks(castVideoTracks: Array<Object>): Array<VideoTrack> {\n    const videoTracks = [];\n    castVideoTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        active: false\n      };\n      videoTracks.push(new VideoTrack(settings));\n    });\n    return videoTracks;\n  }\n\n  _parseAudioTracks(castAudioTracks: Array<Object>): Array<AudioTrack> {\n    const audioTracks = [];\n    castAudioTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        active: false\n      };\n      audioTracks.push(new AudioTrack(settings));\n    });\n    return audioTracks;\n  }\n\n  _selectVideoTrack(track: VideoTrack): void {\n    this._stopOnMediaStatusUpdateInterval();\n    const currentTrack = this.getActiveTracks().video;\n    this._selectTrack(\n      track,\n      currentTrack,\n      () => {\n        this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, {selectedVideoTrack: track}));\n        this._startOnMediaStatusUpdateInterval();\n      },\n      error => {\n        this.dispatchEvent(\n          new FakeEvent(EventType.ERROR, new Error(Error.Severity.RECOVERABLE, Error.Category.CAST, Error.Code.EDIT_TRACKS_INFO_ERROR, error))\n        );\n      }\n    );\n  }\n\n  _selectAudioTrack(track: AudioTrack): void {\n    this._stopOnMediaStatusUpdateInterval();\n    const currentTrack = this.getActiveTracks().audio;\n    this._selectTrack(\n      track,\n      currentTrack,\n      () => {\n        this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, {selectedAudioTrack: track}));\n        this._startOnMediaStatusUpdateInterval();\n      },\n      error => {\n        this.dispatchEvent(\n          new FakeEvent(EventType.ERROR, new Error(Error.Severity.RECOVERABLE, Error.Category.CAST, Error.Code.CAST_EDIT_TRACKS_INFO_ERROR, error))\n        );\n      }\n    );\n  }\n\n  _selectTextTrack(track: TextTrack): void {\n    this._stopOnMediaStatusUpdateInterval();\n    const currentTrack = this.getActiveTracks().text;\n    this._selectTrack(\n      track,\n      currentTrack,\n      () => {\n        this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, {selectedTextTrack: track}));\n        this._startOnMediaStatusUpdateInterval();\n      },\n      error => {\n        this.dispatchEvent(\n          new FakeEvent(EventType.ERROR, new Error(Error.Severity.RECOVERABLE, Error.Category.CAST, Error.Code.EDIT_TRACKS_INFO_ERROR, error))\n        );\n      }\n    );\n  }\n\n  _selectTrack(newTrack: Track, currentTrack: ?Track, onSuccess: Function, onFailed: Function): void {\n    this._logger.debug('Select track', newTrack, currentTrack, this._activeTrackIds);\n    if (currentTrack) {\n      const index = this._activeTrackIds.indexOf(currentTrack.id);\n      if (index > -1) {\n        this._activeTrackIds.splice(index, 1);\n      }\n    }\n    if (newTrack.id && newTrack.language !== 'off') {\n      this._activeTrackIds.push(newTrack.id);\n    }\n    const tracksInfoRequest = new chrome.cast.media.EditTracksInfoRequest(this._activeTrackIds);\n    const mediaSession = this._castSession.getMediaSession();\n    mediaSession.editTracksInfo(\n      tracksInfoRequest,\n      () => {\n        this._logger.debug('Select track succeeded');\n        this._markActiveTrack(currentTrack, false);\n        this._markActiveTrack(newTrack, true);\n        onSuccess();\n      },\n      e => {\n        this._logger.debug('Select track failed', e);\n        onFailed(e);\n      }\n    );\n  }\n\n  _markActiveTrack(track: ?Track, active: boolean): void {\n    if (track) {\n      const {id, language} = track;\n      const origTrack = this._tracks.find(t => t.id === id || (t.language === language && language === 'off'));\n      if (origTrack) {\n        origTrack.active = active;\n      }\n    }\n  }\n\n  _addTextTrackOffOption(): void {\n    const textTracks = this._getTracksByType(TrackType.TEXT);\n    if (textTracks && textTracks.length) {\n      this._tracks.push(\n        new TextTrack({\n          active: true,\n          index: textTracks.length,\n          kind: 'subtitles',\n          label: 'Off',\n          language: 'off'\n        })\n      );\n    }\n  }\n\n  _getTracksByType(type?: string): Array<Track> {\n    return !type\n      ? this._tracks\n      : this._tracks.filter(track => {\n          if (type && TRACK_TYPE_TO_INSTANCE[type]) {\n            return track instanceof TRACK_TYPE_TO_INSTANCE[type];\n          }\n          return true;\n        });\n  }\n\n  _onMediaStatusUpdate(): void {\n    const mediaSession = this._castSession.getMediaSession();\n    if (mediaSession) {\n      const isTextStyleChanged = () => {\n        const localTextStyle = TextStyleConverter.toCastTextStyle(this.textStyle);\n        const remoteTextStyle = mediaSession.media.textTrackStyle;\n        if (remoteTextStyle) {\n          return !(\n            localTextStyle.backgroundColor === remoteTextStyle.backgroundColor &&\n            localTextStyle.fontFamily === remoteTextStyle.fontFamily &&\n            localTextStyle.fontScale === remoteTextStyle.fontScale &&\n            localTextStyle.foregroundColor === remoteTextStyle.foregroundColor\n          );\n        }\n        return false;\n      };\n      const isActiveTrackIdsChanged = () => {\n        if (mediaSession.activeTrackIds) {\n          return !(\n            this._activeTrackIds.length === mediaSession.activeTrackIds.length &&\n            this._activeTrackIds.every((value, index) => value === mediaSession.activeTrackIds[index])\n          );\n        }\n        return false;\n      };\n      if (isActiveTrackIdsChanged()) {\n        const diffIds = mediaSession.activeTrackIds.filter(i => !this._activeTrackIds.includes(i));\n        diffIds.forEach(id => {\n          const track = this._tracks.find(t => t.id === id);\n          this.selectTrack(track);\n        });\n      }\n      if (isTextStyleChanged()) {\n        const style = TextStyleConverter.toPlayerTextStyle(mediaSession.media.textTrackStyle);\n        this._textStyle = style;\n        this.dispatchEvent(new FakeEvent(EventType.TEXT_STYLE_CHANGED, {textStyle: style}));\n      }\n    }\n  }\n}\n\nexport {CastTracksManager};\n","// @flow\nimport {core} from 'kaltura-player-js';\nimport {INTERVAL_FREQUENCY} from './cast-player';\n\nconst {EventType, FakeEvent, FakeEventTarget} = core;\n\nclass CastPlaybackEngine extends FakeEventTarget {\n  _remotePlayer: Object;\n  _remotePlayerController: Object;\n  _mediaSession: Object;\n  _muted: boolean = false;\n  _volume: number = 1;\n  _paused: boolean = false;\n  _currentTime: number = 0;\n  _duration: number = 0;\n  _seeking: boolean = false;\n  _seekForward: boolean;\n  _seekTargetTime: ?number;\n  _liveCurrentTimeIntervalId: IntervalID;\n  _onCurrentTimeChanged: Function;\n  _onIsPausedChanged: Function;\n  _onDurationChanged: Function;\n  _onVolumeLevelChanged: Function;\n  _onIsMutedChanged: Function;\n  _onIsMediaLoadedChanged: Function;\n  _onLiveCurrentTimeChanged: Function;\n\n  constructor(remotePlayer: Object, remotePlayerController: Object) {\n    super();\n    this._remotePlayer = remotePlayer;\n    this._remotePlayerController = remotePlayerController;\n    this._bindEvents();\n    this._toggleListeners(true);\n  }\n\n  reset(): void {\n    this._toggleListeners(false);\n    clearInterval(this._liveCurrentTimeIntervalId);\n    this._resetFlags();\n    this._toggleListeners(true);\n  }\n\n  destroy(): void {\n    clearInterval(this._liveCurrentTimeIntervalId);\n    this._toggleListeners(false);\n    this._muted = false;\n    this._volume = 1;\n    this._resetFlags();\n  }\n\n  play(): void {\n    this._remotePlayerController.playOrPause();\n  }\n\n  pause(): void {\n    if (this._remotePlayer.canPause) {\n      this._remotePlayerController.playOrPause();\n    }\n  }\n\n  set muted(value: boolean) {\n    if ((value && !this.muted) || (!value && this.muted)) {\n      this._remotePlayerController.muteOrUnmute();\n    }\n  }\n\n  set volume(value: number) {\n    if (this._remotePlayer.canControlVolume) {\n      this._remotePlayer.volumeLevel = value;\n      this._remotePlayerController.setVolumeLevel();\n    }\n  }\n\n  set currentTime(value: number) {\n    if (this._remotePlayer.canSeek) {\n      this._seeking = true;\n      this.dispatchEvent(new FakeEvent(EventType.SEEKING));\n      this._remotePlayer.currentTime = this._seekTargetTime = value;\n      this._seekForward = value > this.currentTime;\n      this._remotePlayerController.seek();\n    }\n  }\n\n  get duration(): ?number {\n    return this._duration;\n  }\n\n  get paused(): ?boolean {\n    if (this._remotePlayer.savedPlayerState) {\n      return this._remotePlayer.savedPlayerState.isPaused;\n    }\n    return this._paused;\n  }\n\n  get seeking(): ?boolean {\n    return this._seeking;\n  }\n\n  get muted(): ?boolean {\n    return this._muted;\n  }\n\n  get currentTime(): number {\n    if (this._remotePlayer.savedPlayerState) {\n      return this._remotePlayer.savedPlayerState.currentTime;\n    }\n    return this._currentTime;\n  }\n\n  get volume(): ?number {\n    return this._volume;\n  }\n\n  _resetFlags(): void {\n    this._paused = false;\n    this._currentTime = 0;\n    this._duration = 0;\n    this._seeking = false;\n  }\n\n  _bindEvents(): void {\n    this._onCurrentTimeChanged = this._onCurrentTimeChanged.bind(this);\n    this._onIsPausedChanged = this._onIsPausedChanged.bind(this);\n    this._onDurationChanged = this._onDurationChanged.bind(this);\n    this._onVolumeLevelChanged = this._onVolumeLevelChanged.bind(this);\n    this._onIsMutedChanged = this._onIsMutedChanged.bind(this);\n    this._onIsMediaLoadedChanged = this._onIsMediaLoadedChanged.bind(this);\n    this._onLiveCurrentTimeChanged = this._onLiveCurrentTimeChanged.bind(this);\n  }\n\n  _toggleListeners(listen: boolean): void {\n    const listeners = {\n      [cast.framework.RemotePlayerEventType.IS_MEDIA_LOADED_CHANGED]: this._onIsMediaLoadedChanged,\n      [cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED]: this._onIsPausedChanged,\n      [cast.framework.RemotePlayerEventType.DURATION_CHANGED]: this._onDurationChanged,\n      [cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED]: this._onVolumeLevelChanged,\n      [cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED]: this._onIsMutedChanged\n    };\n    if (listen) {\n      Object.keys(listeners).forEach(e => this._remotePlayerController.addEventListener(e, listeners[e]));\n    } else {\n      Object.keys(listeners).forEach(e => this._remotePlayerController.removeEventListener(e, listeners[e]));\n      this._remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED, this._onCurrentTimeChanged);\n    }\n  }\n\n  _onIsMediaLoadedChanged(isMediaLoadedEvent: Object): void {\n    const onMediaInfoChanged = () => {\n      this._remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED, onMediaInfoChanged);\n      if (this._remotePlayer.mediaInfo.streamType === chrome.cast.media.StreamType.LIVE) {\n        this._mediaSession = cast.framework.CastContext.getInstance().getCurrentSession().getMediaSession();\n        this._liveCurrentTimeIntervalId = setInterval(this._onLiveCurrentTimeChanged, INTERVAL_FREQUENCY);\n      } else {\n        this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED, this._onCurrentTimeChanged);\n      }\n    };\n    if (isMediaLoadedEvent.value) {\n      this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED, onMediaInfoChanged);\n    }\n  }\n\n  _onCurrentTimeChanged(): void {\n    this._currentTime = this._remotePlayer.currentTime;\n    this._maybeDispatchTimeUpdate();\n    this._maybeEndPlayback();\n  }\n\n  _onLiveCurrentTimeChanged(): void {\n    this._currentTime = this._mediaSession.currentTime;\n    this._maybeDispatchTimeUpdate();\n    this._maybeEndLivePlayback();\n  }\n\n  _onIsPausedChanged(): void {\n    this._paused = this._remotePlayer.isPaused;\n    if (this._paused) {\n      this.dispatchEvent(new FakeEvent(EventType.PAUSE));\n    } else {\n      this.dispatchEvent(new FakeEvent(EventType.PLAY));\n    }\n  }\n\n  _onDurationChanged(): void {\n    this._duration = this._remotePlayer.duration;\n    this.dispatchEvent(new FakeEvent(EventType.DURATION_CHANGE));\n  }\n\n  _onVolumeLevelChanged(): void {\n    this._volume = this._remotePlayer.volumeLevel;\n    this.dispatchEvent(new FakeEvent(EventType.VOLUME_CHANGE));\n  }\n\n  _onIsMutedChanged(): void {\n    this._muted = this._remotePlayer.isMuted;\n    this.dispatchEvent(new FakeEvent(EventType.MUTE_CHANGE, {mute: this.muted}));\n  }\n\n  _maybeDispatchTimeUpdate(): void {\n    if (!this._seeking) {\n      this.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n    } else if (\n      this._seekTargetTime &&\n      ((this._seekForward && this.currentTime >= this._seekTargetTime) || (!this._seekForward && this.currentTime <= this._seekTargetTime))\n    ) {\n      this._seeking = false;\n      this._seekTargetTime = null;\n      this.dispatchEvent(new FakeEvent(EventType.SEEKED));\n      this.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n    }\n  }\n\n  _maybeEndPlayback(): void {\n    const delta = Math.round(this._duration - this._currentTime);\n    if (this._currentTime !== 0 && this._duration !== 0 && delta <= 1) {\n      this._currentTime = this._duration;\n      this._paused = true;\n      this.dispatchEvent(new FakeEvent(EventType.ENDED));\n    }\n  }\n\n  _maybeEndLivePlayback(): void {\n    const range = this._mediaSession.liveSeekableRange;\n    if (range && range.isLiveDone) {\n      this._paused = true;\n      this.dispatchEvent(new FakeEvent(EventType.ENDED));\n    }\n  }\n}\n\nexport {CastPlaybackEngine};\n","// @flow\n/** @jsx h */\nimport {cast, ui} from 'kaltura-player-js';\n\n// eslint-disable-next-line no-unused-vars\nconst {style, Components, h} = ui;\nconst {RemotePlayerUI} = cast;\n\nclass CastUI extends RemotePlayerUI {\n  playbackUI(props: Object): any {\n    return (\n      <div className={style.playbackGuiWrapper}>\n        <Components.KeyboardControl player={props.player} config={props.config} />\n        <Components.Loading player={props.player} />\n        <div className={style.playerGui} id=\"player-gui\">\n          <Components.OverlayPortal />\n          <Components.BottomBar>\n            <Components.SeekBarPlaybackContainer showFramePreview showTimeBubble player={props.player} playerContainer={props.playerContainer} />\n            <div className={style.leftControls}>\n              <Components.PlaybackControls player={props.player} />\n              <Components.RewindControl player={props.player} step={10} />\n              <Components.ForwardControl player={props.player} step={10} />\n              <Components.TimeDisplayPlaybackContainer format=\"current / total\" />\n            </div>\n            <div className={style.rightControls}>\n              <Components.VolumeControl player={props.player} />\n              <Components.LanguageControl player={props.player} />\n              <Components.CastControl player={props.player} />\n              <Components.FullscreenControl player={props.player} />\n            </div>\n          </Components.BottomBar>\n          <Components.CastOverlay player={props.player} />\n          <Components.OverlayAction player={props.player} />\n          <Components.PlaybackControls player={props.player} />\n        </div>\n        <Components.PrePlaybackPlayOverlay player={props.player} />\n        <Components.CastAfterPlay player={props.player} />\n      </div>\n    );\n  }\n\n  liveUI(props: Object): any {\n    return (\n      <div className={style.playbackGuiWrapper}>\n        <Components.KeyboardControl player={props.player} config={props.config} />\n        <Components.Loading player={props.player} />\n        <div className={style.playerGui} id=\"player-gui\">\n          <Components.OverlayPortal />\n          <Components.BottomBar>\n            <Components.SeekBarLivePlaybackContainer showFramePreview showTimeBubble player={props.player} playerContainer={props.playerContainer} />\n            <div className={style.leftControls}>\n              <Components.PlaybackControls player={props.player} />\n              <Components.LiveTag player={props.player} />\n            </div>\n            <div className={style.rightControls}>\n              <Components.VolumeControl player={props.player} />\n              <Components.LanguageControl player={props.player} />\n              <Components.CastControl player={props.player} />\n              <Components.FullscreenControl player={props.player} />\n            </div>\n          </Components.BottomBar>\n          <Components.CastOverlay player={props.player} />\n          <Components.OverlayAction player={props.player} />\n          <Components.PlaybackControls player={props.player} />\n        </div>\n        <Components.PrePlaybackPlayOverlay player={props.player} />\n        <Components.CastAfterPlay player={props.player} />\n      </div>\n    );\n  }\n\n  idleUI(props: Object): any {\n    return (\n      <div className={style.playbackGuiWrapper}>\n        <Components.Loading player={props.player} />\n        <Components.CastOverlay player={props.player} />\n      </div>\n    );\n  }\n\n  adsUI(props: Object): any {\n    return (\n      <div className={style.adGuiWrapper}>\n        <Components.KeyboardControl player={props.player} config={props.config} />\n        <Components.Loading player={props.player} />\n        <div className={style.playerGui} id=\"player-gui\">\n          <Components.CastOverlay player={props.player} />\n          <Components.OverlayAction player={props.player} />\n          <div>\n            <Components.TopBar>\n              <div className={style.leftControls}>\n                <Components.AdNotice />\n              </div>\n              <div className={style.rightControls}>\n                <Components.AdLearnMore />\n              </div>\n            </Components.TopBar>\n            <Components.AdSkip player={props.player} />\n          </div>\n          <Components.BottomBar>\n            <div className={style.leftControls}>\n              <Components.PlaybackControls player={props.player} />\n              <Components.TimeDisplayAdsContainer />\n            </div>\n            <div className={style.rightControls}>\n              <Components.VolumeControl player={props.player} />\n              <Components.CastControl player={props.player} />\n              <Components.FullscreenControl player={props.player} />\n            </div>\n          </Components.BottomBar>\n          <Components.PlaybackControls player={props.player} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport {CastUI};\n","// @flow\nimport {core} from 'kaltura-player-js';\n\nconst {Utils, getLogger} = core;\n\nconst SENDER_SDK_URL: string = '//www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1';\n\nclass CastLoader {\n  static _logger: any = getLogger('CastLoader');\n\n  static load(): Promise<*> {\n    return new Promise((resolve, reject) => {\n      window['__onGCastApiAvailable'] = isAvailable => CastLoader._onGCastApiAvailable(isAvailable, resolve);\n      CastLoader._loadCastSDK()\n        .then(() => CastLoader._logger.debug('Cast sender lib has been loaded successfully'))\n        .catch(e => {\n          CastLoader._logger.debug('Cast sender lib loading failed', e);\n          reject(e);\n        });\n    });\n  }\n\n  static _loadCastSDK(): Promise<*> {\n    if (window['cast'] && window['cast']['framework']) {\n      return Promise.resolve();\n    }\n    return Utils.Dom.loadScriptAsync(SENDER_SDK_URL);\n  }\n\n  static _onGCastApiAvailable(isAvailable: boolean, resolve: Function): void {\n    CastLoader._logger.debug(`onGCastApiAvailable, isAvailable: ${isAvailable.toString()}`);\n    if (isAvailable) {\n      resolve();\n    } else {\n      CastLoader._logger.debug(`Google cast API isn't available yet`);\n    }\n  }\n}\n\nexport {CastLoader};\n","// @flow\nimport {CUSTOM_CHANNEL} from './cast-player';\nimport {cast as remote} from 'kaltura-player-js';\n\nconst {CustomActionMessage, CustomActionType} = remote;\n\n/**\n * Cast Ads Controller.\n * @class CastAdsController\n */\nclass CastAdsController {\n  _castSession: Object;\n\n  constructor() {\n    this._castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n  }\n\n  /**\n   * Skips on an ad.\n   * @returns {void}\n   * @memberof CastAdsController\n   * @instance\n   */\n  skipAd(): void {\n    this._castSession.sendMessage(CUSTOM_CHANNEL, new CustomActionMessage(CustomActionType.SKIP_AD));\n  }\n}\n\nexport {CastAdsController};\n","// @flow\nimport {CastPlayer} from './cast-player';\nimport {core} from 'kaltura-player-js';\n\nconst {EventManager, EventType, FakeEventTarget} = core;\n\nclass CastAdsManager extends FakeEventTarget {\n  _castPlayer: CastPlayer;\n  _adBreak: boolean = false;\n  _allAdsCompleted: boolean = true;\n  _eventManager: EventManager;\n\n  constructor(castPlayer: CastPlayer) {\n    super();\n    this._castPlayer = castPlayer;\n    this._eventManager = new EventManager();\n    this._attachListeners();\n  }\n\n  _attachListeners(): void {\n    this._eventManager.listen(this._castPlayer, EventType.AD_MANIFEST_LOADED, () => {\n      this._allAdsCompleted = false;\n    });\n\n    this._eventManager.listen(this._castPlayer, EventType.AD_BREAK_START, () => {\n      this._adBreak = true;\n    });\n\n    this._eventManager.listen(this._castPlayer, EventType.AD_BREAK_END, () => {\n      this._adBreak = false;\n    });\n\n    this._eventManager.listen(this._castPlayer, EventType.ALL_ADS_COMPLETED, () => {\n      this._allAdsCompleted = true;\n    });\n  }\n\n  get adBreak(): boolean {\n    return this._adBreak;\n  }\n\n  get allAdsCompleted(): boolean {\n    return this._allAdsCompleted;\n  }\n\n  reset(): void {\n    this._eventManager.removeAll();\n    this._adBreak = false;\n    this._allAdsCompleted = true;\n    this._attachListeners();\n  }\n\n  destroy(): void {\n    this._adBreak = false;\n    this._allAdsCompleted = true;\n    this._eventManager.destroy();\n  }\n}\n\nexport {CastAdsManager};\n","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {CastStateManager} from './cast-state-manager';\nimport {CastTracksManager} from './cast-tracks-manager';\nimport {CastPlaybackEngine} from './cast-playback-engine';\nimport {CastUI} from './cast-ui';\nimport {CastLoader} from './cast-loader';\nimport {CastAdsController} from './cast-ads-controller';\nimport {CastAdsManager} from './cast-ads-manager';\n\nconst {Env, Track, TextStyle, EventType, StateType, FakeEvent, Utils, EngineType, AbrMode, Error} = core;\nconst {\n  BaseRemotePlayer,\n  PlayerSnapshot,\n  RemoteControl,\n  RemoteConnectedPayload,\n  RemoteDisconnectedPayload,\n  RemoteAvailablePayload,\n  RemoteSession,\n  TextStyleConverter,\n  CustomMessageType,\n  CustomMessage,\n  CustomEventMessage\n} = remote;\n\nexport const INTERVAL_FREQUENCY = 500;\nexport const SECONDS_TO_MINUTES_DIVIDER = 60;\nexport const CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\n\n/**\n * The threshold in seconds from duration that we still consider it as live edge\n * @type {number}\n * @const\n */\nconst LIVE_EDGE_THRESHOLD: number = 10;\n\n/**\n * Cast Sender Player.\n * @class CastPlayer\n * @param {CastConfigObject} config - The cast configuration.\n * @param {RemoteControl} remoteControl - The remote control.\n * @extends BaseRemotePlayer\n */\nclass CastPlayer extends BaseRemotePlayer {\n  /**\n   * The remote player type.\n   * @static\n   * @type {string}\n   * @memberof CastPlayer\n   * @override\n   */\n  static Type: string = 'chromecast';\n\n  /**\n   * @function isSupported\n   * @static\n   * @returns {boolean} - Whether the cast player is supported in the current runtime environment.\n   * @memberof CastPlayer\n   * @override\n   */\n  static isSupported(): boolean {\n    return Env.browser.name === 'Chrome' && Env.os.name !== 'iOS';\n  }\n\n  /**\n   * The default cast configuration.\n   * @static\n   * @type {Object}\n   * @memberof CastPlayer\n   * @override\n   */\n  static defaultConfig: Object = {\n    liveEdgeThreshold: 5\n  };\n\n  _remoteSession: RemoteSession;\n  _castSession: Object;\n  _castContext: Object;\n  _castRemotePlayer: Object;\n  _castRemotePlayerController: Object;\n  _ui: CastUI;\n  _stateManager: CastStateManager;\n  _tracksManager: CastTracksManager;\n  _engine: CastPlaybackEngine;\n  _readyPromise: ?Promise<*> = null;\n  _mediaInfo: ?Object = null;\n  _firstPlay: boolean = true;\n  _ended: boolean = false;\n  _playbackStarted: boolean = false;\n  _reset: boolean = true;\n  _destroyed: boolean = false;\n  _isOnLiveEdge: boolean = false;\n  _mediaInfoIntervalId: IntervalID;\n  _adsController: CastAdsController;\n  _adsManager: CastAdsManager;\n\n  constructor(castConfig: CastConfigObject, remoteControl: RemoteControl) {\n    super('CastPlayer', castConfig, remoteControl);\n    CastLoader.load()\n      .then(() => {\n        this._initializeCastApi();\n        this._initializeRemotePlayer();\n      })\n      .catch(e => {\n        CastPlayer._logger.error('Cast initialized error', e);\n      });\n  }\n\n  /**\n   * Loads a media to the receiver application.\n   * @param {ProviderMediaInfoObject} mediaInfo - The entry media info.\n   * @param {Object} [options] - The request options. See {@link https://developers.google.com/cast/docs/reference/chrome/chrome.cast.media.LoadRequest|chrome.cast.media.LoadRequest}\n   * @returns {Promise<void>} - Promise to indicate load succeed or failed.\n   * @instance\n   * @memberof CastPlayer\n   */\n  loadMedia(mediaInfo: Object, options?: Object): Promise<*> {\n    CastPlayer._logger.debug('Load media', mediaInfo, options);\n    this._mediaInfo = mediaInfo;\n    return this._castMedia({mediaInfo}, options);\n  }\n\n  /**\n   * Set a media to the receiver application.\n   * @param {ProviderMediaConfigObject} mediaConfig - The entry media config.\n   * @param {Object} [options] - The request options. See {@link https://developers.google.com/cast/docs/reference/chrome/chrome.cast.media.LoadRequest|chrome.cast.media.LoadRequest}\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  setMedia(mediaConfig: Object, options?: Object): void {\n    CastPlayer._logger.debug('Set media', mediaConfig, options);\n    this._castMedia({mediaConfig}, options);\n  }\n\n  /**\n   * Gets the media Info.\n   * @returns {ProviderMediaInfoObject} - The media info.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getMediaInfo(): ?Object {\n    return Utils.Object.copyDeep(this._mediaInfo);\n  }\n\n  /**\n   * Gets the media config.\n   * @returns {ProviderMediaConfigObject} - The media config.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getMediaConfig(): ?Object {\n    const mediaConfig = {\n      sources: this._playerConfig.sources,\n      plugins: this._playerConfig.plugins\n    };\n    return Utils.Object.copyDeep(mediaConfig);\n  }\n\n  /**\n   * The cast player readiness.\n   * @returns {Promise<*>} - Promise which resolved when the cast player is ready.\n   * @instance\n   * @memberof CastPlayer\n   */\n  ready(): Promise<*> {\n    return this._readyPromise ? this._readyPromise : Promise.resolve();\n  }\n\n  /**\n   * Start/resume playback.\n   * @instance\n   * @returns {void}\n   * @memberof CastPlayer\n   */\n  play(): void {\n    if (!this.ended || this._adsManager.adBreak) {\n      this._engine.play();\n    } else {\n      this._loadOrSetMedia({\n        mediaInfo: this._mediaInfo,\n        mediaConfig: this.getMediaConfig()\n      });\n    }\n  }\n\n  /**\n   * Pause playback.\n   * @instance\n   * @returns {void}\n   * @memberof CastPlayer\n   */\n  pause(): void {\n    this._engine.pause();\n  }\n\n  /**\n   * Stops and reset the cast player.\n   * @instance\n   * @returns {void}\n   * @memberof CastPlayer\n   */\n  reset(): void {\n    clearInterval(this._mediaInfoIntervalId);\n    if (this._reset) return;\n    this._reset = true;\n    this._firstPlay = true;\n    this._ended = false;\n    this._isOnLiveEdge = false;\n    this._tracksManager.reset();\n    this._engine.reset();\n    this._adsManager.reset();\n    this._stateManager.reset();\n    this._readyPromise = this._createReadyPromise();\n    this.dispatchEvent(new FakeEvent(EventType.PLAYER_RESET));\n  }\n\n  /**\n   * Destroys the cast player.\n   * @instance\n   * @returns {void}\n   * @memberof CastPlayer\n   */\n  destroy(): void {\n    clearInterval(this._mediaInfoIntervalId);\n    if (this._destroyed) return;\n    this._destroyed = true;\n    this._firstPlay = true;\n    this._ended = false;\n    this._isOnLiveEdge = false;\n    this._readyPromise = null;\n    this._eventManager.destroy();\n    this._tracksManager.destroy();\n    this._engine.destroy();\n    this._adsManager.destroy();\n    this._stateManager.destroy();\n    this.dispatchEvent(new FakeEvent(EventType.PLAYER_DESTROY));\n  }\n\n  /**\n   * @returns {boolean} - Whether the current playback is a live playback.\n   * @instance\n   * @memberof CastPlayer\n   */\n  isLive(): boolean {\n    const mediaInfo = this._castRemotePlayer.mediaInfo;\n    return mediaInfo ? mediaInfo.streamType === chrome.cast.media.StreamType.LIVE : false;\n  }\n\n  /**\n   * Get whether the video is seeked to live edge in dvr\n   * @returns {boolean} - Whether the video is seeked to live edge in dvr\n   * @public\n   */\n  isOnLiveEdge(): boolean {\n    return this._isOnLiveEdge;\n  }\n\n  /**\n   * @returns {boolean} - Whether the current live playback has DVR window. In case of non-live playback will return false.\n   * @instance\n   * @memberof CastPlayer\n   */\n  isDvr(): boolean {\n    if (this.isLive()) {\n      const mediaSession = this._castSession.getMediaSession();\n      if (mediaSession) {\n        const range = mediaSession.liveSeekableRange;\n        if (range) {\n          const startMinutes = range.start / SECONDS_TO_MINUTES_DIVIDER;\n          const endMinutes = range.end / SECONDS_TO_MINUTES_DIVIDER;\n          return endMinutes - startMinutes > this._castConfig.liveEdgeThreshold;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Seeks to the live edge.\n   * @instance\n   * @returns {void}\n   * @memberof CastPlayer\n   */\n  seekToLiveEdge(): void {\n    const mediaSession = this._castSession.getMediaSession();\n    if (mediaSession) {\n      const range = mediaSession.liveSeekableRange;\n      if (range) {\n        this._engine.currentTime = range.end;\n      }\n    }\n  }\n\n  /**\n   * @returns {number} - The start time of the DVR window.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getStartTimeOfDvrWindow(): number {\n    const mediaSession = this._castSession.getMediaSession();\n    if (mediaSession) {\n      const range = mediaSession.liveSeekableRange;\n      if (range) {\n        return range.start;\n      }\n    }\n    return 0;\n  }\n\n  /**\n   * @function enableAdaptiveBitrate\n   * @description Enables automatic adaptive bitrate switching.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n\n  /**\n   * @function isAdaptiveBitrateEnabled\n   * @returns {boolean} - Whether adaptive bitrate is enabled.\n   * @instance\n   * @memberof CastPlayer\n   */\n\n  /**\n   * @param {string} [type] - Track type.\n   * @returns {Array<Track>} - The cast player tracks.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getTracks(type?: string): Array<Track> {\n    return this._tracksManager.getTracks(type);\n  }\n\n  /**\n   * @returns {Object} - The cast player active tracks.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getActiveTracks(): Object {\n    return this._tracksManager.getActiveTracks();\n  }\n\n  /**\n   * Select a certain track to be active.\n   * @param {Track} track - The track to activate.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  selectTrack(track: ?Track): void {\n    this._tracksManager.selectTrack(track);\n  }\n\n  /**\n   * Hides the active text track.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  hideTextTrack(): void {\n    this._tracksManager.hideTextTrack();\n  }\n\n  /**\n   * Start casting.\n   * @returns {Promise<*>} - A promise to indicate session is starting, or failed\n   * @instance\n   * @memberof CastPlayer\n   */\n  startCasting(): Promise<*> {\n    return cast && cast.framework ? cast.framework.CastContext.getInstance().requestSession() : Promise.reject();\n  }\n\n  /**\n   * @returns {boolean} - Whether casting is available.\n   * @instance\n   * @memberof CastPlayer\n   */\n  isCastAvailable(): boolean {\n    return !!this._castRemotePlayer;\n  }\n\n  /**\n   * Stops the current cast session.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  stopCasting(): void {\n    this._castSession.endSession(true);\n  }\n\n  /**\n   * Gets the current remote session.\n   * @returns {RemoteSession} - The remote session.\n   * @instance\n   * @memberof CastPlayer\n   */\n  getCastSession(): RemoteSession {\n    return Utils.Object.copyDeep(this._remoteSession);\n  }\n\n  /**\n   * @return {CastAdsController} - The cast ads controller.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get ads(): ?CastAdsController {\n    return this._adsController;\n  }\n\n  /**\n   * Setter.\n   * @param {TextStyle} style - The text style to set.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  set textStyle(style: TextStyle): void {\n    this._tracksManager.textStyle = style;\n  }\n\n  /**\n   * Getter.\n   * @returns {TextStyle} - The current text style.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get textStyle(): ?TextStyle {\n    return this._tracksManager.textStyle;\n  }\n\n  /**\n   * Setter.\n   * @param {number} to - The number to set in seconds.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  set currentTime(to: number): void {\n    this._engine.currentTime = to;\n  }\n\n  /**\n   * Getter.\n   * @returns {number} - The current time in seconds.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get currentTime(): ?number {\n    return this._engine.currentTime;\n  }\n\n  /**\n   * @returns {number} - The duration in seconds.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get duration(): ?number {\n    return this._engine.duration;\n  }\n\n  /**\n   * Setter.\n   * @param {number} vol - The volume to set in the range of 0-1.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  set volume(vol: number): void {\n    this._engine.volume = vol;\n  }\n\n  /**\n   * Getter.\n   * @returns {number} - The current volume in the range of 0-1.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get volume(): ?number {\n    return this._engine.volume;\n  }\n\n  /**\n   * @returns {boolean} - Whether the cast player is in paused state.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get paused(): ?boolean {\n    return this._engine.paused;\n  }\n\n  /**\n   * @returns {boolean} - Whether the cast player is in ended state.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get ended(): ?boolean {\n    return this._ended;\n  }\n\n  /**\n   * @returns {boolean} - Whether the cast player is in seeking state.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get seeking(): ?boolean {\n    return this._engine.seeking;\n  }\n\n  /**\n   * Setter.\n   * @param {boolean} mute - The mute value to set.\n   * @returns {void}\n   * @instance\n   * @memberof CastPlayer\n   */\n  set muted(mute: boolean): void {\n    this._engine.muted = mute;\n  }\n\n  /**\n   * Getter.\n   * @returns {boolean} - The muted state.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get muted(): ?boolean {\n    return this._engine.muted;\n  }\n\n  /**\n   * @returns {string} - The current playing source url.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get src(): ?string {\n    if (this._castRemotePlayer.mediaInfo) {\n      return this._castRemotePlayer.mediaInfo.contentUrl;\n    }\n    return '';\n  }\n\n  /**\n   * @returns {string} - The current poster url.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get poster(): string {\n    try {\n      return this._castRemotePlayer.mediaInfo.metadata.images[0].url;\n    } catch (e) {\n      return '';\n    }\n  }\n\n  /**\n   * @returns {string} - The current playback rate.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get playbackRate(): ?number {\n    const mediaSession = this._castSession.getMediaSession();\n    if (mediaSession) {\n      return mediaSession.playbackRate;\n    }\n    return null;\n  }\n\n  /**\n   * @returns {string} - The active engine type.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get engineType(): ?string {\n    return EngineType.CAST;\n  }\n\n  /**\n   * @returns {string} - The remote player type.\n   * @instance\n   * @memberof CastPlayer\n   */\n  get type(): string {\n    return CastPlayer.Type;\n  }\n\n  /**\n   * @name config\n   * @returns {Object} - The runtime cast player config.\n   * @instance\n   * @memberof CastPlayer\n   */\n\n  _initializeCastApi(): void {\n    const options: Object = {};\n\n    options.receiverApplicationId = this._castConfig.receiverApplicationId || chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID;\n    options.autoJoinPolicy = this._castConfig.autoJoinPolicy || chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED;\n\n    CastPlayer._logger.debug('Init cast API with options', options);\n    const castContext = cast.framework.CastContext.getInstance();\n    castContext.setOptions(options);\n    castContext.addEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED, event => {\n      const payload = new RemoteAvailablePayload(this, event.castState !== cast.framework.CastState.NO_DEVICES_AVAILABLE);\n      this._remoteControl.onRemoteDeviceAvailable(payload);\n    });\n  }\n\n  _initializeRemotePlayer(): void {\n    this._castContext = cast.framework.CastContext.getInstance();\n    this._addSessionLifecycleListeners();\n    this._castRemotePlayer = new cast.framework.RemotePlayer();\n    this._castRemotePlayerController = new cast.framework.RemotePlayerController(this._castRemotePlayer);\n    this._castRemotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED, () => {\n      if (this._castRemotePlayer.isConnected) {\n        this._setupRemotePlayer();\n      } else {\n        this._setupLocalPlayer();\n      }\n    });\n  }\n\n  _setupRemotePlayer(): void {\n    CastPlayer._logger.debug('Setup remote player');\n    this._castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n    this._castSession.addMessageListener(CUSTOM_CHANNEL, (customChannel, customMessage) => this._onCustomMessage(customChannel, customMessage));\n    this._tracksManager = new CastTracksManager(this._castRemotePlayer);\n    this._engine = new CastPlaybackEngine(this._castRemotePlayer, this._castRemotePlayerController);\n    this._stateManager = new CastStateManager(this._castRemotePlayer, this._castRemotePlayerController);\n    this._adsManager = new CastAdsManager(this);\n    this._ui = new CastUI();\n    this._attachListeners();\n    const snapshot = this._remoteControl.getPlayerSnapshot();\n    this._playerConfig = snapshot.config;\n    this._remoteSession = new RemoteSession(\n      this._castSession.getSessionId(),\n      this._castSession.getCastDevice().friendlyName,\n      this._castSession.getSessionState() !== cast.framework.SessionState.SESSION_STARTED\n    );\n    const payload = new RemoteConnectedPayload(this, this._remoteSession, this._ui);\n    this._remoteControl.onRemoteDeviceConnected(payload);\n    if (this._remoteSession.resuming && !(Env.browser.major >= 73 && Env.os.name === 'Android')) {\n      // Android Chrome 73 and up gets SESSION_RESUMED also in the initial session\n      this._resumeSession();\n    } else if (snapshot) {\n      const loadOptions = this._getLoadOptions(snapshot);\n      this._loadOrSetMedia(snapshot, loadOptions);\n    }\n  }\n\n  _loadOrSetMedia(mediaObject: Object, options?: Object): void {\n    const {mediaInfo, mediaConfig} = mediaObject;\n    if (mediaInfo) {\n      this.loadMedia(mediaInfo, options);\n    } else if (mediaConfig) {\n      this.setMedia({sources: mediaObject.mediaConfig.sources, plugins: {}}, options);\n    }\n  }\n\n  _castMedia(mediaObject: Object, options?: Object): Promise<*> {\n    this.reset();\n    this._remoteControl.getUIWrapper().reset();\n\n    if (this._playbackStarted) {\n      this.dispatchEvent(new FakeEvent(EventType.CHANGE_SOURCE_STARTED));\n    }\n    const media = new chrome.cast.media.MediaInfo();\n    const request = new chrome.cast.media.LoadRequest(media);\n\n    if (options) {\n      Object.keys(options).forEach(option => {\n        if (option !== 'media') {\n          // $FlowFixMe\n          request[option] = options[option];\n        } else {\n          // $FlowFixMe\n          Object.keys(options.media).forEach(mediaOption => {\n            // $FlowFixMe\n            media[mediaOption] = options.media[mediaOption];\n          });\n        }\n      });\n    }\n\n    media.customData = media.customData || {};\n    media.customData.mediaInfo = mediaObject.mediaInfo;\n    media.customData.mediaConfig = mediaObject.mediaConfig;\n    return this._castSession.loadMedia(request).then(\n      () => this._onLoadMediaSuccess(),\n      error => this._onLoadMediaFailed(error)\n    );\n  }\n\n  _setupLocalPlayer(): void {\n    CastPlayer._logger.debug('Setup local player');\n    const snapshot = new PlayerSnapshot(this);\n    const payload = new RemoteDisconnectedPayload(this, snapshot);\n    this.pause();\n    this.destroy();\n    this._remoteControl.onRemoteDeviceDisconnected(payload);\n  }\n\n  _createReadyPromise(): void {\n    this._readyPromise = new Promise(resolve => {\n      this._eventManager.listenOnce(this, EventType.TRACKS_CHANGED, () => {\n        this.dispatchEvent(new FakeEvent(EventType.MEDIA_LOADED));\n        resolve();\n      });\n    });\n  }\n\n  _attachListeners(): void {\n    this._eventManager.listen(this._engine, EventType.TIME_UPDATE, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.PAUSE, e => this._onPause(e));\n    this._eventManager.listen(this._engine, EventType.PLAY, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.VOLUME_CHANGE, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.MUTE_CHANGE, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.DURATION_CHANGE, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.ENDED, e => this._onEnded(e));\n    this._eventManager.listen(this._engine, EventType.SEEKING, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._engine, EventType.SEEKED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.TRACKS_CHANGED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.TEXT_TRACK_CHANGED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.VIDEO_TRACK_CHANGED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.AUDIO_TRACK_CHANGED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.TEXT_STYLE_CHANGED, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._tracksManager, EventType.ERROR, e => this.dispatchEvent(e));\n    this._eventManager.listen(this._stateManager, EventType.PLAYER_STATE_CHANGED, e => this._onPlayerStateChanged(e));\n  }\n\n  _onPause(e: FakeEvent): void {\n    this._isOnLiveEdge = false;\n    this._eventManager.listenOnce(this._engine, EventType.PLAY, () => {\n      this._isOnLiveEdge = true;\n    });\n    this.dispatchEvent(e);\n  }\n\n  _onEnded(e: FakeEvent): void {\n    this._ended = true;\n    this.dispatchEvent(e);\n    if (this._adsManager.allAdsCompleted) {\n      this.dispatchEvent(new FakeEvent(EventType.PLAYBACK_ENDED));\n    } else {\n      this._eventManager.listenOnce(this, EventType.ALL_ADS_COMPLETED, () => {\n        this.dispatchEvent(new FakeEvent(EventType.PLAYBACK_ENDED));\n      });\n    }\n  }\n\n  _onPlayerStateChanged(e: FakeEvent): void {\n    if (this._ended) return;\n    if (this._stateManager.currentState.type === StateType.PLAYING) {\n      this.dispatchEvent(new FakeEvent(EventType.PLAYING));\n    }\n    this.dispatchEvent(e);\n  }\n\n  _handleFirstPlay(): void {\n    if (this._playbackStarted) {\n      this.dispatchEvent(new FakeEvent(EventType.CHANGE_SOURCE_ENDED));\n    }\n    this.dispatchEvent(new FakeEvent(EventType.PLAYBACK_START));\n    this.dispatchEvent(new FakeEvent(EventType.PLAY));\n    this.dispatchEvent(new FakeEvent(EventType.FIRST_PLAY));\n    this.dispatchEvent(new FakeEvent(EventType.FIRST_PLAYING));\n    this.dispatchEvent(new FakeEvent(EventType.PLAYING));\n    if (this.paused) {\n      this.dispatchEvent(new FakeEvent(EventType.PAUSE));\n    }\n    this._firstPlay = false;\n    this._playbackStarted = true;\n  }\n\n  _resumeSession(): void {\n    this._readyPromise = this._createReadyPromise();\n    this._mediaInfoIntervalId = setInterval(() => {\n      const mediaSession = this._castSession.getMediaSession();\n      if (mediaSession && mediaSession.customData) {\n        clearInterval(this._mediaInfoIntervalId);\n        this._mediaInfo = mediaSession.customData.mediaInfo;\n        CastPlayer._logger.debug('Resuming session with media info', this._mediaInfo);\n        this._onLoadMediaSuccess();\n      }\n    }, INTERVAL_FREQUENCY);\n  }\n\n  _onLoadMediaSuccess(): void {\n    CastPlayer._logger.debug('Load media success');\n    this._reset = false;\n    this._triggerInitialPlayerEvents();\n    this._tracksManager.parseTracks();\n    this._handleFirstPlay();\n    let startTime = this._playerConfig.playback.startTime;\n    if (this.isLive() && (startTime === -1 || (typeof this.duration === 'number' && startTime >= this.duration - LIVE_EDGE_THRESHOLD))) {\n      this._isOnLiveEdge = true;\n    }\n  }\n\n  _triggerInitialPlayerEvents(): void {\n    this.dispatchEvent(\n      new FakeEvent(EventType.SOURCE_SELECTED, {\n        selectedSource: [\n          {\n            url: this._castRemotePlayer.mediaInfo.contentUrl,\n            mimetype: this._castRemotePlayer.mediaInfo.contentType\n          }\n        ]\n      })\n    );\n    this.dispatchEvent(new FakeEvent(EventType.LOADED_METADATA));\n    this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, {mode: AbrMode.AUTO}));\n  }\n\n  _onLoadMediaFailed(error: Object): void {\n    CastPlayer._logger.debug('Load media falied', error);\n    this.dispatchEvent(\n      new FakeEvent(EventType.ERROR, new Error(Error.Severity.CRITICAL, Error.Category.CAST, Error.Code.CAST_LOAD_MEDIA_FAILED, error))\n    );\n  }\n\n  _addSessionLifecycleListeners(): void {\n    this._castContext.addEventListener(cast.framework.CastContextEventType.SESSION_STATE_CHANGED, event => {\n      switch (event.sessionState) {\n        case cast.framework.SessionState.SESSION_STARTING:\n          this._remoteControl.onRemoteDeviceConnecting();\n          break;\n        case cast.framework.SessionState.SESSION_RESUMED:\n          if (Env.browser.major >= 73 && Env.os.name === 'Android') {\n            this._remoteControl.onRemoteDeviceConnecting();\n          }\n          break;\n        case cast.framework.SessionState.SESSION_ENDING:\n          this._remoteControl.onRemoteDeviceDisconnecting();\n          break;\n        case cast.framework.SessionState.SESSION_START_FAILED:\n          this._remoteControl.onRemoteDeviceConnectFailed();\n          break;\n      }\n    });\n  }\n\n  _getLoadOptions(snapshot: PlayerSnapshot): Object {\n    const loadOptions = {\n      autoplay: this._playerConfig.playback.autoplay,\n      currentTime: this._playerConfig.playback.startTime,\n      media: {}\n    };\n    if (this.textStyle && !this.textStyle.isEqual(snapshot.textStyle)) {\n      loadOptions.media.textTrackStyle = TextStyleConverter.toCastTextStyle(snapshot.textStyle);\n    }\n    loadOptions.media.customData = {\n      audioLanguage: this._playerConfig.playback.audioLanguage,\n      textLanguage: this._playerConfig.playback.textLanguage\n    };\n    if (snapshot.advertising && snapshot.advertising.adTagUrl) {\n      this._adsController = new CastAdsController();\n      const castAdvertising = this._castConfig.advertising;\n      if (!castAdvertising || !castAdvertising.vast) {\n        loadOptions.media.vmapAdsRequest = this._getAdsRequest(snapshot.advertising);\n      } else {\n        const breakClipId = Utils.Generator.uniqueId(5);\n        const breakId = Utils.Generator.uniqueId(5);\n        const breakClips = [\n          {\n            id: breakClipId,\n            position: 0,\n            vastAdsRequest: this._getAdsRequest(snapshot.advertising)\n          }\n        ];\n        const breaks = [\n          {\n            breakClipIds: [breakClipId],\n            id: breakId,\n            position: 0\n          }\n        ];\n        loadOptions.media.breakClips = breakClips;\n        loadOptions.media.breaks = breaks;\n      }\n    }\n    const externalCaptions = this._getExternalCaptions();\n    externalCaptions.length && (loadOptions.media.tracks = externalCaptions);\n    return loadOptions;\n  }\n\n  _getExternalCaptions() {\n    const externalCaptions = [];\n    if (this._playerConfig.sources.captions && this._playerConfig.sources.captions.length) {\n      this._playerConfig.sources.captions.forEach((caption, index) => {\n        if (caption.type === 'vtt' || caption.url.endsWith('.vtt')) {\n          let newTrack;\n          newTrack = new chrome.cast.media.Track(index + 1, chrome.cast.media.TrackType.TEXT);\n          Utils.Object.mergeDeep(newTrack, {\n            trackContentId: caption.url,\n            trackContentType: 'text/vtt',\n            name: caption.label,\n            language: caption.language\n          });\n          externalCaptions.push(newTrack);\n        } else {\n          CastPlayer._logger.warn(`Text track type ${caption.type} is unsupported by Cast receiver`);\n        }\n      });\n    }\n    return externalCaptions;\n  }\n\n  _getAdsRequest(advertising: Object): Object {\n    const adsRequest = {};\n    if (advertising.adTagUrl) {\n      adsRequest.adTagUrl = advertising.adTagUrl;\n    }\n    if (advertising.adsResponse) {\n      adsRequest.adsResponse = advertising.adsResponse;\n    }\n    return adsRequest;\n  }\n\n  _onCustomMessage(customChannel: string, customMessage: CustomMessage): void {\n    try {\n      const parsedCustomMessage = JSON.parse(customMessage);\n      CastPlayer._logger.debug('Custom message received', parsedCustomMessage);\n      switch (parsedCustomMessage.type) {\n        case CustomMessageType.EVENT:\n          this._handleCustomEvent(parsedCustomMessage);\n          break;\n      }\n    } catch (e) {\n      this.dispatchEvent(\n        new FakeEvent(EventType.ERROR, new Error(Error.Severity.RECOVERABLE, Error.Category.CAST, Error.Code.CAST_CUSTOM_MESSAGE_PARSING_ERROR, e))\n      );\n    }\n  }\n\n  _handleCustomEvent(customEvent: CustomEventMessage): void {\n    this.dispatchEvent(new FakeEvent(customEvent.event, customEvent.payload));\n  }\n}\n\nexport {CastPlayer};\n","// @flow\nimport {CastPlayer} from './cast-player';\nimport {cast} from 'kaltura-player-js';\n\nconst {registerRemotePlayer} = cast;\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nconst NAME = __NAME__;\nconst VERSION = __VERSION__;\n\nexport {CastPlayer as RemotePlayer};\nexport {VERSION, NAME};\n\nif (CastPlayer.isSupported()) {\n  registerRemotePlayer(CastPlayer.Type, CastPlayer);\n}\n"],"sourceRoot":""}